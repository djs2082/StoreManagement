{"ast":null,"code":"var _jsxFileName = \"/home/dilip/Desktop/MERN/himalaya/src/components/statistics2.component.js\";\n\n/*\n * inspired by shirley wu's blog post \n * https://medium.com/@sxywu/on-d3-react-and-a-little-bit-of-flux-88a226f328f3#.e46japl3o\n * still working on axis\n */\nfunction makeRandomNumber(max, min) {\n  return Math.floor(Math.random() * (max - min)) + min;\n} // d3 update part\n\n\nvar visualization = {\n  enter: (selection, xScale, yScale) => {\n    var yZeroPoint = yScale(0);\n    selection.select('rect.bar').attr('x', d => xScale(d.x)).attr('y', yZeroPoint).attr('height', 0).attr('width', xScale.rangeBand()).transition().duration(300).attr('y', d => yScale(d.y)).attr('height', d => yZeroPoint - yScale(d.y));\n    selection.select('text.index').attr('x', d => xScale.rangeBand() * 2 / 5 + xScale(d.x)).attr('y', yZeroPoint + 20);\n    selection.select('text.value').attr('x', d => xScale.rangeBand() * 1 / 8 + xScale(d.x)).attr('y', yZeroPoint + 20).transition().duration(300).attr('y', d => yScale(d.y) - 10);\n  },\n  update: (selection, xScale, yScale) => {\n    var yZeroPoint = yScale(0);\n    selection.select('rect.bar').attr('x', d => xScale(d.x)).attr('y', yZeroPoint).attr('height', 0).attr('width', xScale.rangeBand()).transition().duration(300).attr('y', d => yScale(d.y)).attr('height', d => yZeroPoint - yScale(d.y));\n    selection.select('text.index').attr('x', d => xScale.rangeBand() * 2 / 5 + xScale(d.x)).attr('y', yZeroPoint + 20);\n    selection.select('text.value').attr('x', d => xScale.rangeBand() * 2 / 8 + xScale(d.x)).attr('y', yZeroPoint + 20).transition().duration(300).attr('y', d => yScale(d.y) - 10);\n  }\n};\nvar tickVisualization = {\n  enter: (selection, transX, transY, zeroPoint) => {\n    selection.attr('transform', 'translate(' + transX + ',' + zeroPoint + ')').transition().attr('transform', 'translate(' + transX + ',' + transY + ')');\n  }\n}; // used in Tick component\n\nvar horizonLine = d3.svg.line().y(d => d.y).x(d => d.x);\nvar Graph = React.createClass({\n  displayName: \"Graph\",\n\n  getInitialState() {\n    return {\n      data: []\n    };\n  },\n\n  componentDidMount() {\n    this.updateData(); //setInterval(this.updateData, 3000);\n  },\n\n  updateData() {\n    var dataLen = makeRandomNumber(5, 10);\n    var data = d3.range(dataLen).map(i => {\n      return {\n        x: i,\n        y: makeRandomNumber(1000, 10000)\n      };\n    });\n    this.setState({\n      data: data\n    });\n  },\n\n  render() {\n    var svgSize = {\n      width: 400,\n      height: 400\n    };\n    return /*#__PURE__*/React.createElement(BarChart, {\n      svgSize: svgSize,\n      data: this.state.data,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 7\n      }\n    });\n  }\n\n});\nvar BarChart = React.createClass({\n  displayName: \"BarChart\",\n\n  render() {\n    var svgMargin = {\n      top: 30,\n      right: 20,\n      bottom: 30,\n      left: 50\n    };\n    var xScale = d3.scale.ordinal().rangeBands([svgMargin.left, this.props.svgSize.width - svgMargin.right], .2).domain(this.props.data.map(d => d.x));\n    var yScale = d3.scale.linear().range([this.props.svgSize.height - svgMargin.top, svgMargin.bottom]).domain([0, d3.max(this.props.data, d => d.y)]);\n    var bars = this.props.data.map(d => {\n      return /*#__PURE__*/React.createElement(Bar, {\n        data: d,\n        xScale: xScale,\n        yScale: yScale,\n        svgSize: this.props.svgSize,\n        barWidth: 10,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 9\n        }\n      });\n    });\n    return /*#__PURE__*/React.createElement(\"svg\", {\n      width: this.props.svgSize.width,\n      height: this.props.svgSize.height,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Axis, {\n      scale: yScale,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 9\n      }\n    }), bars);\n  }\n\n});\nvar Tick = React.createClass({\n  displayName: \"Tick\",\n\n  componentDidMount() {\n    var horizonLineData = [{\n      x: 0,\n      y: 0\n    }, {\n      x: 400,\n      y: 0\n    }];\n    this.d3Node = d3.select(React.findDOMNode(this));\n    tickVisualization.enter(this.d3Node, this.props.transX, this.props.transY, this.props.zeroPoint);\n    this.d3Node.select('path').datum(horizonLineData).attr('d', horizonLine);\n  },\n\n  shouldComponentUpdate() {\n    return true;\n  },\n\n  componentWillUpdate(nextProps) {\n    var horizonLineData = [{\n      x: 0,\n      y: 0\n    }, {\n      x: 400,\n      y: 0\n    }];\n    tickVisualization.enter(this.d3Node, nextProps.transX, nextProps.transY, nextProps.zeroPoint);\n    this.d3Node.select('path').datum(horizonLineData).attr('d', horizonLine);\n  },\n\n  format(d) {\n    var formatNumber = d3.format('^5d');\n    return '$' + formatNumber(d);\n  },\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"g\", {\n      className: \"tick\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"text\", {\n      fill: \"#888\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }\n    }, this.format(this.props.tick)), /*#__PURE__*/React.createElement(\"path\", {\n      className: \"horizon\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 9\n      }\n    }));\n  }\n\n});\nvar Axis = React.createClass({\n  displayName: \"Axis\",\n\n  render() {\n    var scale = this.props.scale.copy();\n    var ticks = scale.ticks(4);\n    var transX = -30;\n    var tickComps = ticks.map(t => {\n      var transY = scale(t);\n      var zeroPoint = scale(0);\n      return /*#__PURE__*/React.createElement(Tick, {\n        transX: transX,\n        transY: transY,\n        tick: t,\n        zeroPoint: zeroPoint,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 9\n        }\n      });\n    });\n    return /*#__PURE__*/React.createElement(\"g\", {\n      className: \"y-axis\",\n      transform: \"translate(30,0)\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 7\n      }\n    }, tickComps);\n  }\n\n});\nvar Bar = React.createClass({\n  displayName: \"Bar\",\n\n  getInitialState() {\n    return {\n      barColor: 'steelblue',\n      barClass: 'bar'\n    };\n  },\n\n  componentDidMount() {\n    this.d3Node = d3.select(React.findDOMNode(this));\n    visualization.enter(this.d3Node.datum(this.props.data), this.props.xScale, this.props.yScale);\n  },\n\n  shouldComponentUpdate() {\n    return true;\n  },\n\n  componentDidUpdate(prevProps) {\n    if (prevProps !== this.props) {\n      visualization.update(this.d3Node.datum(this.props.data), this.props.xScale, this.props.yScale);\n    }\n  },\n\n  mouseOverHandler() {\n    this.setState({\n      barClass: 'bar-active'\n    });\n  },\n\n  mouseOutHandler() {\n    this.setState({\n      barClass: 'bar'\n    });\n  },\n\n  render() {\n    var yZeroPoint = this.props.yScale(0);\n    return /*#__PURE__*/React.createElement(\"g\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"rect\", {\n      className: this.state.barClass,\n      onMouseOver: this.mouseOverHandler,\n      onMouseOut: this.mouseOutHandler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"text\", {\n      className: \"index\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 9\n      }\n    }, this.props.data.x + 1), /*#__PURE__*/React.createElement(\"text\", {\n      className: \"value\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 9\n      }\n    }, this.props.data.y));\n  }\n\n});\nReact.render( /*#__PURE__*/React.createElement(Graph, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 214,\n    columnNumber: 14\n  }\n}), document.getElementById(\"main\"));","map":{"version":3,"sources":["/home/dilip/Desktop/MERN/himalaya/src/components/statistics2.component.js"],"names":["makeRandomNumber","max","min","Math","floor","random","visualization","enter","selection","xScale","yScale","yZeroPoint","select","attr","d","x","rangeBand","transition","duration","y","update","tickVisualization","transX","transY","zeroPoint","horizonLine","d3","svg","line","Graph","React","createClass","getInitialState","data","componentDidMount","updateData","dataLen","range","map","i","setState","render","svgSize","width","height","state","BarChart","svgMargin","top","right","bottom","left","scale","ordinal","rangeBands","props","domain","linear","bars","Tick","horizonLineData","d3Node","findDOMNode","datum","shouldComponentUpdate","componentWillUpdate","nextProps","format","formatNumber","tick","Axis","copy","ticks","tickComps","t","Bar","barColor","barClass","componentDidUpdate","prevProps","mouseOverHandler","mouseOutHandler","document","getElementById"],"mappings":"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","sourcesContent":["/*\n * inspired by shirley wu's blog post \n * https://medium.com/@sxywu/on-d3-react-and-a-little-bit-of-flux-88a226f328f3#.e46japl3o\n * still working on axis\n */\nfunction makeRandomNumber(max, min) {\n  return Math.floor(Math.random() * (max - min)) + min;\n}\n\n// d3 update part\nvar visualization = {\n  enter: (selection, xScale, yScale) => {\n    var yZeroPoint = yScale(0);\n    selection.select('rect.bar').attr('x', (d) => xScale(d.x))\n             .attr('y', yZeroPoint)\n             .attr('height', 0)\n             .attr('width', xScale.rangeBand())\n             .transition()\n             .duration(300)\n             .attr('y', (d) => yScale(d.y))\n             .attr('height', (d) => yZeroPoint - yScale(d.y));\n    \n    selection.select('text.index').attr('x', (d) => xScale.rangeBand() * 2 / 5 + xScale(d.x))\n             .attr('y', yZeroPoint + 20);\n    \n    selection.select('text.value').attr('x', (d) => xScale.rangeBand() * 1 / 8 + xScale(d.x))\n             .attr('y', yZeroPoint + 20)\n             .transition()\n             .duration(300)\n             .attr('y', (d) => yScale(d.y) - 10);\n  },\n  update: (selection, xScale, yScale) => {\n    var yZeroPoint = yScale(0);\n    selection.select('rect.bar').attr('x', (d) => xScale(d.x))\n             .attr('y', yZeroPoint)\n             .attr('height', 0)\n             .attr('width', xScale.rangeBand())\n             .transition()\n             .duration(300)\n             .attr('y', (d) => yScale(d.y))\n             .attr('height', (d) => yZeroPoint - yScale(d.y));\n    \n    selection.select('text.index').attr('x', (d) => xScale.rangeBand() * 2 / 5 + xScale(d.x))\n             .attr('y', yZeroPoint + 20);\n    \n    selection.select('text.value').attr('x', (d) => xScale.rangeBand() * 2 / 8 + xScale(d.x))\n             .attr('y', yZeroPoint + 20)\n             .transition()\n             .duration(300)\n             .attr('y', (d) => yScale(d.y) - 10);\n  }\n};\n\nvar tickVisualization = {\n  enter: (selection, transX, transY, zeroPoint) => {\n    selection\n      .attr('transform', 'translate(' + transX + ',' + zeroPoint + ')')\n      .transition()\n      .attr('transform', 'translate(' + transX + ',' + transY + ')');\n  }\n}\n// used in Tick component\nvar horizonLine = d3.svg.line()\n.y((d) => d.y)\n.x((d) => d.x);\n\nvar Graph = React.createClass({\n  \n  getInitialState() {\n    return {\n      data: []\n    };\n  },\n  \n  componentDidMount() {\n    this.updateData();\n    //setInterval(this.updateData, 3000);\n  },\n  \n  updateData() {\n    var dataLen = makeRandomNumber(5,10);\n    var data = d3.range(dataLen).map((i) => {\n      return {x: i, y: makeRandomNumber(1000, 10000)};\n    });\n    this.setState({data: data});\n  },\n  \n  render () {\n    var svgSize={width: 400, height:400}\n    return (\n      <BarChart svgSize={svgSize} data={this.state.data}/>\n    );\n  }\n});\n\nvar BarChart = React.createClass({\n  render() {\n    var svgMargin = {top: 30, right: 20, bottom: 30, left:50}\n    var xScale = d3.scale.ordinal()\n                         .rangeBands([svgMargin.left ,this.props.svgSize.width - svgMargin.right],.2)\n                         .domain(this.props.data.map((d) => d.x));\n    var yScale = d3.scale.linear()\n                         .range([this.props.svgSize.height - svgMargin.top, svgMargin.bottom])\n                         .domain([0, d3.max(this.props.data, (d) => d.y)]);\n    \n    var bars = this.props.data.map((d) => {\n      return (\n        <Bar data={d} xScale={xScale} yScale={yScale} svgSize={this.props.svgSize} barWidth={10} />\n        );\n    })\n    return (\n      <svg width={this.props.svgSize.width} \n           height={this.props.svgSize.height}>\n        <Axis scale={yScale}/>\n        {bars}\n      </svg>\n    );\n  }\n});\n\nvar Tick = React.createClass({\n  componentDidMount() {\n    var horizonLineData = [{x: 0, y: 0}, {x: 400, y: 0}];\n    this.d3Node = d3.select(React.findDOMNode(this));\n    tickVisualization.enter(this.d3Node, this.props.transX, this.props.transY, this.props.zeroPoint);\n    this.d3Node.select('path').datum(horizonLineData)\n    .attr('d', horizonLine);\n  },\n  shouldComponentUpdate() {\n    return true;\n  },\n  componentWillUpdate(nextProps) {\n    var horizonLineData = [{x: 0, y: 0}, {x: 400, y: 0}];\n    tickVisualization.enter(this.d3Node, nextProps.transX, nextProps.transY, nextProps.zeroPoint);\n    this.d3Node.select('path').datum(horizonLineData)\n    .attr('d', horizonLine);\n  },\n  format(d) {\n    var formatNumber = d3.format('^5d')\n    return '$' + formatNumber(d);\n  },\n  render() {\n    return (\n      <g className=\"tick\">\n        <text fill=\"#888\">{this.format(this.props.tick)}</text>\n        <path className=\"horizon\"></path>\n      </g>\n    );\n  }\n});\n\nvar Axis = React.createClass({\n  \n  render() {\n    var scale = this.props.scale.copy();\n    \n    var ticks = scale.ticks(4);\n    var transX = -30;\n    var tickComps = ticks.map((t) => {\n      var transY = scale(t);\n      var zeroPoint = scale(0);\n      return (\n        <Tick transX={transX} transY={transY} tick={t} zeroPoint={zeroPoint}/>\n      );\n    })\n    return (\n      <g className=\"y-axis\" transform=\"translate(30,0)\">\n        {tickComps}\n      </g>\n    );\n  }\n});\n\nvar Bar = React.createClass({\n  getInitialState() {\n    return {\n      barColor: 'steelblue',\n      barClass: 'bar'\n    };\n  },\n  componentDidMount() {\n    this.d3Node = d3.select(React.findDOMNode(this));\n    visualization.enter(this.d3Node.datum(this.props.data), this.props.xScale, this.props.yScale);\n  },\n  shouldComponentUpdate() {\n    return true;\n  },\n  componentDidUpdate(prevProps) {\n    if (prevProps !== this.props) {\n      visualization.update(this.d3Node.datum(this.props.data), this.props.xScale, this.props.yScale);\n    }\n  },\n  mouseOverHandler() {\n    this.setState({barClass: 'bar-active'});\n  },\n  mouseOutHandler() {\n    this.setState({barClass: 'bar'});\n  },\n  render() {\n    var yZeroPoint = this.props.yScale(0);\n    return (\n      <g>\n        <rect className={this.state.barClass}\n              onMouseOver = {this.mouseOverHandler}\n              onMouseOut = {this.mouseOutHandler}>\n        </rect>\n        <text className=\"index\">{this.props.data.x + 1}</text>\n        <text className=\"value\">{this.props.data.y}</text>\n      </g>\n    );\n  }\n});\n\nReact.render(<Graph />, document.getElementById(\"main\"));"]},"metadata":{},"sourceType":"module"}