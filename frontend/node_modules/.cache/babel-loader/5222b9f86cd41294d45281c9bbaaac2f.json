{"ast":null,"code":"var _jsxFileName = \"/home/dilip/Desktop/MERN/himalayadonelocal2/src/components/sale.component.js\";\nimport React, { Component } from 'react';\nimport { MDBDataTableV5 } from 'mdbreact';\nimport Menu from './menu.component';\nimport '../css/sale.css';\nimport axios from 'axios';\n\nclass Customer extends Component {\n  constructor(props) {\n    super(props);\n\n    this.errorOccured = (status, err, message) => {\n      let error = {\n        \"id\": this.state.errors.length + 1,\n        \"status\": status,\n        \"error\": err,\n        \"message\": message\n      };\n      let errors = this.state.errors;\n      errors.push(error);\n      this.setState(errors);\n    };\n\n    this.deleteError = e => {\n      let key = e.currentTarget.parentNode.getAttribute(\"data-key\");\n      let errors = this.state.errors.filter(error => {\n        return parseInt(error.id) !== parseInt(key);\n      });\n      this.setState({\n        errors: errors\n      });\n    };\n\n    this.update_rows = response => {\n      try {\n        let columns = this.state.datatable.columns;\n        let rows = this.state.datatable.rows;\n\n        if (response.status === 200) {\n          response.Data.results.forEach(element => {\n            if (element.customer != null) {\n              var row = {\n                'fname': element.customer.fname,\n                'lname': element.customer.lname,\n                'mobile': element.customer.mobile,\n                'amount_payable': element.amount_payable,\n                'total_discount': element.total_discount,\n                'payment_method': element.payment_method.name ? \"\" : \"deleted\",\n                'date': element.customer.date,\n                'receipt_pdf': element.receipt_pdf ? /*#__PURE__*/React.createElement(\"a\", {\n                  href: element.receipt_pdf,\n                  target: \"blank\",\n                  __self: this,\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 133,\n                    columnNumber: 343\n                  }\n                }, \"click\") : \"\"\n              };\n              rows.push(row);\n            }\n          });\n          let datatable = {\n            columns: columns,\n            rows: rows\n          };\n          this.setState({\n            datatable: datatable\n          });\n        }\n      } catch (error) {\n        this.errorOccured(500, \"erro occurred\", error.toString());\n      }\n    };\n\n    this.get_next = response => {\n      try {\n        const headers = {\n          'Authorization': 'Token ' + sessionStorage.getItem('token')\n        };\n        axios.get(response, {\n          headers: headers\n        }).then(result => {\n          this.update_rows(result.data);\n\n          if (result.data.Data.links.next != null) {\n            this.get_next(result.data.Data.links.next);\n          }\n        });\n      } catch (error) {\n        this.errorOccured(500, \"erro occurred\", error.toString());\n      }\n    };\n\n    this.componentDidMount = () => {\n      const headers = {\n        'Authorization': 'Token ' + sessionStorage.getItem('token')\n      };\n      axios.get(window.API_URL + '/receipts/', {\n        headers: headers\n      }).then(response => {\n        if (response.status == 200) {\n          if (response.data.status == 404) {\n            this.errorOccured(404, response.data.error.error, \"Error\");\n          } else if (response.data.status == 200) {\n            this.update_rows(response.data);\n            this.get_next(response.data.Data.links.next);\n          } else {\n            this.errorOccured(response.data.status, response.error.error, \"Unknown Error Occurred\");\n          }\n        } else {\n          this.errorOccured(500, \"erro occurred\", \"Unknown error occurred\");\n        }\n      }).catch(error => {\n        this.errorOccured(500, \"error occurred\", error.message);\n      });\n    };\n\n    if (sessionStorage.getItem('token') === 'undefined' || sessionStorage.getItem('username') === 'undefined') {\n      this.props.history.push('/');\n    }\n\n    this.state = {\n      datatable: {\n        columns: [{\n          label: 'FirstName',\n          field: 'fname',\n          width: 150\n        }, {\n          label: 'LastName',\n          field: 'lname',\n          width: 270\n        }, {\n          label: 'Mobile',\n          field: 'mobile',\n          width: 270\n        }, {\n          label: 'Amount Paid',\n          field: 'amount_payable',\n          width: 200\n        }, {\n          label: 'Discount Provided',\n          field: 'total_discount',\n          sort: 'disabled',\n          width: 150\n        }, {\n          label: 'Payment Type',\n          field: 'payment_method',\n          width: 270\n        }, {\n          label: 'Date',\n          field: 'date',\n          width: 270\n        }, {\n          label: 'Reciept',\n          field: 'receipt_pdf',\n          width: 270\n        }],\n        rows: []\n      },\n      errors: []\n    };\n    this.payments = \"\";\n    var _headers = {\n      'Authorization': 'Token ' + sessionStorage.getItem('token')\n    };\n    axios.get(window.API_URL + '/payments/payments_today/', {\n      headers: _headers\n    }).then(response => {\n      if (response.status == 200) {\n        if (response.data.status == 404) {\n          this.errorOccured(404, response.data.error.error, \"Error\");\n        } else if (response.data.status == 200) {\n          var payments = response.data.Data.amount_wise_payment_list.map(payment => {\n            return /*#__PURE__*/React.createElement(\"tr\", {\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 81,\n                columnNumber: 23\n              }\n            }, \" \", /*#__PURE__*/React.createElement(\"th\", {\n              style: {\n                color: \"green\"\n              },\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 81,\n                columnNumber: 28\n              }\n            }, payment.name ? payment.name : \"deleted payment option\"), /*#__PURE__*/React.createElement(\"td\", {\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 81,\n                columnNumber: 120\n              }\n            }, payment.amount));\n          });\n          var total_amount = response.data.Data.total_amount_paid_today;\n          this.setState({\n            payments: payments,\n            total_amount: total_amount\n          });\n        } else {\n          this.errorOccured(response.data.status, response.error.error, \"Unknown Error Occurred\");\n        }\n      } else {\n        this.errorOccured(500, \"erro occurred\", \"Unknown error occurred\");\n      }\n    }).catch(error => {\n      console.log(\"errro catched\");\n      this.errorOccured(500, \"error occurred\", error.message);\n    });\n  }\n\n  render() {\n    var Error = this.state.errors.length ? this.state.errors.map(error => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        \"data-key\": error.id,\n        className: \"alert alert-danger alert-dismissible override\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"#\",\n        onClick: this.deleteError,\n        class: \"close\",\n        \"data-dismiss\": \"alert\",\n        \"aria-label\": \"close\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 9\n        }\n      }, \"\\xD7\"), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 14\n        }\n      }, \"error!\"), \" \", error.error), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 14\n        }\n      }, \"message\"), \" \", error.message), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 14\n        }\n      }, \"status\"), \" \", error.status));\n    }) : \"\";\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Menu, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 9\n      }\n    }), Error, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        backgroundColor: \"black\",\n        fontSize: \"15px\",\n        color: \"green\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(MDBDataTableV5, {\n      className: \"table-responsive\",\n      style: {\n        backgroundColor: \"black\",\n        fontSize: \"20px\",\n        color: \"white\"\n      },\n      hover: true,\n      entriesOptions: [10, 20, 25],\n      entries: 10,\n      pagesAmount: 4,\n      data: this.state.datatable,\n      searchTop: true,\n      searchBottom: false,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        textAlign: \"left\",\n        backgroundColor: \"black\",\n        fontSize: \"20px\",\n        color: \"white\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"table\", {\n      style: {\n        width: \"100%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      style: {\n        color: \"red\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 15\n      }\n    }, \"Payment Type\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 15\n      }\n    }, \"Amount Paid\")), this.state.payments, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      style: {\n        color: \"blue\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 15\n      }\n    }, \"Total\"), /*#__PURE__*/React.createElement(\"td\", {\n      style: {\n        color: \"blue\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 15\n      }\n    }, this.state.total_amount)))));\n  }\n\n}\n\nexport default Customer;","map":{"version":3,"sources":["/home/dilip/Desktop/MERN/himalayadonelocal2/src/components/sale.component.js"],"names":["React","Component","MDBDataTableV5","Menu","axios","Customer","constructor","props","errorOccured","status","err","message","error","state","errors","length","push","setState","deleteError","e","key","currentTarget","parentNode","getAttribute","filter","parseInt","id","update_rows","response","columns","datatable","rows","Data","results","forEach","element","customer","row","fname","lname","mobile","amount_payable","total_discount","payment_method","name","date","receipt_pdf","toString","get_next","headers","sessionStorage","getItem","get","then","result","data","links","next","componentDidMount","window","API_URL","catch","history","label","field","width","sort","payments","amount_wise_payment_list","map","payment","color","amount","total_amount","total_amount_paid_today","console","log","render","Error","backgroundColor","fontSize","textAlign"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { MDBDataTableV5 } from 'mdbreact';\nimport Menu from './menu.component'\nimport '../css/sale.css';\nimport axios from 'axios';\n\n\nclass Customer extends Component {\n  constructor(props) {\n    super(props);\n    if (sessionStorage.getItem('token') === 'undefined' || sessionStorage.getItem('username') === 'undefined') {\n      this.props.history.push('/')\n    }\n    this.state = {\n      datatable: {\n        columns: [\n          {\n            label: 'FirstName',\n            field: 'fname',\n            width: 150,\n          },\n          {\n            label: 'LastName',\n            field: 'lname',\n            width: 270,\n          },\n          {\n            label: 'Mobile',\n            field: 'mobile',\n            width: 270,\n          },\n          {\n            label: 'Amount Paid',\n            field: 'amount_payable',\n            width: 200,\n          },\n          {\n            label: 'Discount Provided',\n            field: 'total_discount',\n            sort: 'disabled',\n            width: 150,\n          },\n          {\n            label: 'Payment Type',\n            field: 'payment_method',\n            width: 270,\n          },\n          {\n            label: 'Date',\n            field: 'date',\n            width: 270,\n          },\n          {\n            label: 'Reciept',\n            field: 'receipt_pdf',\n            width: 270,\n          }\n        ],\n        rows: [\n        ],\n      },\n      errors: []\n    }\n    this.payments = \"\";\n    var headers = {\n      'Authorization': 'Token ' + sessionStorage.getItem('token')\n    }\n    axios.get(window.API_URL+'/payments/payments_today/', {\n      headers: headers\n    })\n      .then(response => {\n\n        if (response.status == 200) {\n\n          if (response.data.status == 404) {\n            this.errorOccured(404, response.data.error.error, \"Error\")\n          }\n\n          else if (response.data.status == 200) {\n            var payments = response.data.Data.amount_wise_payment_list.map(payment => {\n              return (<tr> <th style={{ color: \"green\" }}>{payment.name?(payment.name):(\"deleted payment option\")}</th><td>{payment.amount}</td></tr>)\n            })\n            var total_amount = response.data.Data.total_amount_paid_today\n            this.setState({ payments: payments, total_amount: total_amount })\n\n          }\n          else {\n\n            this.errorOccured(response.data.status, response.error.error, \"Unknown Error Occurred\")\n          }\n        }\n        else {\n\n          this.errorOccured(500, \"erro occurred\", \"Unknown error occurred\")\n\n        }\n      })\n      .catch(error => {\n        console.log(\"errro catched\")\n        this.errorOccured(500, \"error occurred\", error.message)\n      });\n  }\n\n  errorOccured = (status, err, message) => {\n    let error = { \"id\": this.state.errors.length + 1, \"status\": status, \"error\": err, \"message\": message }\n    let errors = this.state.errors\n    errors.push(error)\n\n    this.setState(errors)\n  }\n\n  deleteError = (e) => {\n    let key = e.currentTarget.parentNode.getAttribute(\"data-key\");\n\n    let errors = this.state.errors.filter(error => {\n      return parseInt(error.id) !== parseInt(key);\n    })\n    this.setState({ errors: errors })\n  }\n\n\n\n  update_rows = (response) => {\n\n    try {\n      let columns = this.state.datatable.columns\n      let rows = this.state.datatable.rows\n      if (response.status === 200) {\n\n        response.Data.results.forEach(element => {\n\n          if (element.customer != null) {\n            var row = { 'fname': element.customer.fname, 'lname': element.customer.lname, 'mobile': element.customer.mobile, 'amount_payable': element.amount_payable, 'total_discount': element.total_discount, 'payment_method': element.payment_method.name?(\"\"):(\"deleted\"), 'date': element.customer.date, 'receipt_pdf': element.receipt_pdf ? (<a href={element.receipt_pdf} target=\"blank\">click</a>) : (\"\") }\n\n            rows.push(row)\n          }\n        }\n        )\n\n        let datatable = { columns: columns, rows: rows }\n        this.setState({ datatable: datatable })\n      }\n    }\n    catch (error) {\n      this.errorOccured(500, \"erro occurred\", error.toString())\n\n    }\n  }\n\n  get_next = (response) => {\n    try {\n      const headers = {\n        'Authorization': 'Token ' + sessionStorage.getItem('token')\n      }\n\n      axios.get(response, { headers: headers })\n        .then(result => {\n          this.update_rows(result.data);\n          if (result.data.Data.links.next != null) {\n            this.get_next(result.data.Data.links.next)\n          }\n        })\n    }\n    catch (error) {\n      this.errorOccured(500, \"erro occurred\", error.toString())\n\n    }\n\n  }\n\n  componentDidMount = () => {\n    const headers = {\n      'Authorization': 'Token ' + sessionStorage.getItem('token')\n    }\n    axios.get(window.API_URL+'/receipts/', {\n      headers: headers\n    })\n      .then(response => {\n\n        if (response.status == 200) {\n\n          if (response.data.status == 404) {\n            this.errorOccured(404, response.data.error.error, \"Error\")\n          }\n\n          else if (response.data.status == 200) {\n            this.update_rows(response.data);\n            this.get_next(response.data.Data.links.next)\n\n          }\n          else {\n\n            this.errorOccured(response.data.status, response.error.error, \"Unknown Error Occurred\")\n          }\n        }\n        else {\n\n          this.errorOccured(500, \"erro occurred\", \"Unknown error occurred\")\n\n        }\n      })\n      .catch(error => {\n\n        this.errorOccured(500, \"error occurred\", error.message)\n      });\n\n\n  }\n\n  render() {\n    var Error = this.state.errors.length ? this.state.errors.map(error => {\n      return (<div data-key={error.id} className='alert alert-danger alert-dismissible override'>\n        <a href=\"#\" onClick={this.deleteError} class=\"close\" data-dismiss=\"alert\" aria-label=\"close\">&times;</a>\n        <div><strong>error!</strong> {error.error}</div>\n        <div><strong>message</strong> {error.message}</div>\n        <div><strong>status</strong> {error.status}</div></div>)\n    }) : (\"\")\n    return (\n      <div>\n        <Menu />\n        {Error}\n        <div style={{ backgroundColor: \"black\", fontSize: \"15px\", color: \"green\" }}>\n          <MDBDataTableV5 className=\"table-responsive\" style={{ backgroundColor: \"black\", fontSize: \"20px\", color: \"white\" }} hover entriesOptions={[10, 20, 25]} entries={10} pagesAmount={4} data={this.state.datatable} searchTop searchBottom={false} />\n        </div>\n        <div style={{ textAlign: \"left\", backgroundColor: \"black\", fontSize: \"20px\", color: \"white\" }}>\n          <table style={{ width: \"100%\" }}>\n            <tr style={{ color: \"red\" }}>\n              <th>Payment Type</th>\n              <th>Amount Paid</th>\n            </tr>\n\n\n            {this.state.payments}\n            <tr>\n              <th style={{ color: \"blue\" }}>Total</th>\n              <td style={{ color: \"blue\" }}>{this.state.total_amount}</td>\n            </tr>\n          </table>\n        </div>\n\n      </div>\n\n    )\n\n  }\n}\nexport default Customer;"]},"metadata":{},"sourceType":"module"}